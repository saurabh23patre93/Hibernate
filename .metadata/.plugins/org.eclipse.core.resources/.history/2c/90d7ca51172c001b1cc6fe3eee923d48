package com.nt.dao;

import java.util.Set;

import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.Transaction;

import com.nt.entity.PhoneNumber;
import com.nt.entity.UserInfo;
import com.nt.utility.HibernateUtil;

public class OneToManyDAOImpl implements OneToManyDAO {

	@Override
	public void saveDataUsingParent() {
		//Get Session
		Session ses=HibernateUtil.getSession();
		//Prepare Object
		//Child object
		PhoneNumber ph1=new PhoneNumber(899999L,"Resident","airtel");
		PhoneNumber ph2=new PhoneNumber(444563L,"Office","Vi");
		Set<PhoneNumber> phonesSet=Set.of(ph1,ph2);
		//Parent Object
		UserInfo user=new UserInfo("Suresh","hyd");
		//Set Childs to Parent
		user.setPhones(phonesSet);
		
		Transaction tx=null;
		boolean flag=false;
		try {
			//Begin tx
			if(!ses.getTransaction().isActive())
				tx=ses.beginTransaction();
			//Save object
			ses.save(user);
			flag=true;
		} catch (HibernateException e) {
			e.printStackTrace();
			flag=false;
		}
	}

}
